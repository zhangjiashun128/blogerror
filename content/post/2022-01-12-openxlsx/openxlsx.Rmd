---
title: Openxlsx包的使用介绍
author: jiashun zhang
date: '2022-01-12'
slug: openxlsx
categories:
  - R与EXCEL交互工具包
tags:
  - R Markdown
  - Excel
---

## 1. openxlsx包的主要函数列表

+-----------------------------+-----------------------------------+
| 函数名                      | 功能                              |
+=============================+===================================+
| createWorkbook              | 创建一个工作簿                    |
+-----------------------------+-----------------------------------+
| addWorksheet                | 为工作簿添加一个工作表            |
+-----------------------------+-----------------------------------+
| mergeCells                  | 合并单元格                        |
+-----------------------------+-----------------------------------+
| makeHyperlinkString         | 创建超链接                        |
+-----------------------------+-----------------------------------+
| writeData                   | 将数据写入到工作表                |
+-----------------------------+-----------------------------------+
| insertImage                 | 将图片插入到工作表                |
+-----------------------------+-----------------------------------+
| insertPlot                  | 将当前绘图插入到工作表            |
+-----------------------------+-----------------------------------+
| getSheetNames               | 获取工作表名字                    |
+-----------------------------+-----------------------------------+
| renameWorksheet             | 重命名工作表                      |
+-----------------------------+-----------------------------------+
| conditionalFormat           | 为单元格添加条件格式              |
+-----------------------------+-----------------------------------+
| addStyle                    | 为单元格设置格式                  |
+-----------------------------+-----------------------------------+
| addFilter                   | 为工作表添加筛选功能              |
+-----------------------------+-----------------------------------+
| replaceStyle                | 替换单元格格式                    |
+-----------------------------+-----------------------------------+
| freezePane                  | 冻结工作表窗口                    |
+-----------------------------+-----------------------------------+
| worksheetOrder              | 对工作表进行排序                  |
+-----------------------------+-----------------------------------+
| modifyBaseFont              | 设置默认字体                      |
+-----------------------------+-----------------------------------+
| saveWorkbook                | 保存工作簿到文件                  |
+-----------------------------+-----------------------------------+
| setRowHeights               | 设置工作表行高                    |
+-----------------------------+-----------------------------------+
| showGridLines               | 隐藏网格线                        |
+-----------------------------+-----------------------------------+
| setColWidths                | 设置工作表列宽                    |
+-----------------------------+-----------------------------------+

: openxlsx包的主要函数列表

## 2. openxlsx包的使用介绍

### 2.1 创建Excel文档

使用createWorkbook()创建一个Excel工作簿，然后使用saveWorkbook()将工作簿保存到本地文件夹中。

```{r echo=TRUE}
library(openxlsx)
wb <- createWorkbook()
saveWorkbook(wb, file = 'test.xlsx')
```

## 2.2 数据读取与输出

### 2.2.1 数据输出

```{r echo=TRUE}
addWorksheet(wb, "iris") #在Excel表中增加iris工作表
iris_head <- head(iris, 20) 
#查看iris的前20行
writeData(wb, #之前创建的Excel表
          "iris", #指定写入数据的工作表
          iris_head, #要写入工作表的数据
          startCol = 1, #从哪一列开始写入数据
          startRow = 1, #从哪一行开始写入数据
          rowNames = TRUE #写入数据框的行名
          )
saveWorkbook(wb,
             file = 'test.xlsx',
             overwrite =TRUE)
             #为TRUE时覆盖已经存在的文件
```

### 2.2.2 数据读入

```{r}
data <- read.xlsx('test.xlsx', #要读取的xlsx文件
                  detectDates = TRUE, #识别日期数据并进行转换
                  fillMergedCells = TRUE)#若为TRUE,则合并单元格中的值将其提供给合并的所有单元格。
```

```{r}
head(data)
```
